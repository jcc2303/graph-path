/* src/graph/Connection.svelte generated by Svelte v3.35.0 */
import { SvelteComponent, init, safe_not_equal } from "../_snowpack/pkg/svelte/internal.js";

import { onMount } from "../_snowpack/pkg/svelte.js";

import {
	width,
	height,
	canvas as canvasStore,
	context as contextStore,
	pixelRatio
} from "../stores.js";

function instance($$self, $$props, $$invalidate) {
	let { item } = $$props;

	const repaint = context => {
		let { from, to } = item;
		context.beginPath();
		context.moveTo(from.x, from.y);
		context.lineTo(to.x, to.y);

		// head
		let headlen = 20; // length of head in pixels

		let dx = to.x - from.x;
		let dy = to.y - from.y;
		let angle = Math.atan2(dy, dx);
		context.lineTo(to.x - headlen * Math.cos(angle - Math.PI / 6), to.y - headlen * Math.sin(angle - Math.PI / 6));
		context.moveTo(to.x, to.y);
		context.lineTo(to.x - headlen * Math.cos(angle + Math.PI / 6), to.y - headlen * Math.sin(angle + Math.PI / 6));
		context.stroke();
	};

	const unsubscribe = contextStore.subscribe(value => {
		value && repaint(value);
	});

	$$self.$$set = $$props => {
		if ("item" in $$props) $$invalidate(0, item = $$props.item);
	};

	return [item];
}

class Connection extends SvelteComponent {
	constructor(options) {
		super();
		init(this, options, instance, null, safe_not_equal, { item: 0 });
	}
}

export default Connection;